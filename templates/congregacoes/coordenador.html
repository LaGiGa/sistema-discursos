{% extends "base.html" %}

{% block title %}Coordenador de Discursos - {{ congregacao.nome }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-person-gear"></i> Coordenador de Discursos</h2>
    <a href="{{ url_for('listar_congregacoes') }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Voltar para Congregações
    </a>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="bi bi-house-door"></i> {{ congregacao.nome }}
                </h5>
            </div>
            <div class="card-body">
                <!-- Coordenador Atual -->
                {% if coordenador %}
                <div class="alert alert-success">
                    <h6><i class="bi bi-person-check"></i> Coordenador Atual</h6>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <p class="mb-1"><strong>Nome:</strong> {{ coordenador.orador.nome }}</p>
                            <p class="mb-1"><strong>Telefone:</strong> {{ coordenador.telefone or 'Não informado' }}</p>
                        </div>
                        <div class="col-md-6">
                            <p class="mb-1"><strong>Desde:</strong> {{ coordenador.data_inicio.strftime('%d/%m/%Y') }}</p>
                            <p class="mb-0"><strong>Status:</strong> <span class="badge bg-success">Ativo</span></p>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="alert alert-warning">
                    <i class="bi bi-exclamation-triangle"></i> 
                    Nenhum coordenador definido para esta congregação.
                </div>
                {% endif %}

                <!-- Formulário para Definir Coordenador -->
                <h6 class="mt-4 mb-3">
                    <i class="bi bi-pencil-square"></i> 
                    {% if coordenador %}Alterar{% else %}Definir{% endif %} Coordenador
                </h6>
                
                <form method="POST">
                    <div class="row g-3">
                        <!-- Orador -->
                        <div class="col-md-6">
                            <label for="orador_id" class="form-label">Orador *</label>
                            <select class="form-select" id="orador_id" name="orador_id" required>
                                <option value="">Selecione um orador</option>
                                {% for orador in oradores %}
                                    <option value="{{ orador.id }}" 
                                            {% if coordenador and coordenador.orador_id == orador.id %}selected{% endif %}>
                                        {{ orador.nome }}
                                        {% if orador.telefone %} - {{ orador.telefone }}{% endif %}
                                    </option>
                                {% endfor %}
                            </select>
                            <div class="form-text">Selecione o orador que será o coordenador</div>
                        </div>

                        <!-- Telefone -->
                        <div class="col-md-6">
                            <label for="telefone" class="form-label">Telefone para Contato</label>
                            <input type="text" class="form-control" id="telefone" name="telefone" 
                                   value="{{ coordenador.telefone if coordenador else '' }}" 
                                   placeholder="(00) 00000-0000">
                            <div class="form-text">Telefone do coordenador para contato</div>
                        </div>
                    </div>

                    <!-- Botões -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-save"></i> 
                                    {% if coordenador %}Atualizar{% else %}Definir{% endif %} Coordenador
                                </button>
                                {% if coordenador %}
                                <a href="{{ url_for('listar_congregacoes') }}" class="btn btn-secondary">
                                    <i class="bi bi-x-circle"></i> Cancelar
                                </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Informações da Congregação -->
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h6 class="card-title mb-0">
                    <i class="bi bi-info-circle"></i> Informações da Congregação
                </h6>
            </div>
            <div class="card-body">
                <p class="mb-2"><strong>Nome:</strong> {{ congregacao.nome }}</p>
                <p class="mb-2"><strong>Localidade:</strong> {{ congregacao.localidade }}</p>
                <p class="mb-2"><strong>Oradores Ativos:</strong> {{ oradores|length }}</p>
                <p class="mb-0"><strong>Status:</strong> 
                    <span class="badge bg-success">Ativa</span>
                </p>

                <hr>

                <h6>Funções do Coordenador:</h6>
                <ul class="small mb-0">
                    <li>Organizar a escala de discursos</li>
                    <li>Comunicar-se com os oradores</li>
                    <li>Acompanhar discursos agendados</li>
                    <li>Coordenar eventos especiais</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}